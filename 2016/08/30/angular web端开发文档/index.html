<!DOCTYPE html>
<html>
	<head>
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="Welcome to tvChan&#39;s Blog!">
    

    <!--Author-->
    
        <meta name="author" content="tvChan">
    

    <!-- Title -->
    
    <title>angular web端开发文档 | tvChan&#39;s Blog</title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Custom Fonts -->
    <link href="//at.alicdn.com/t/font_1of8hhckxro7ds4i.css" rel="stylesheet" type="text/css">
    <!-- Highlight -->
    <link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.2.0/styles/tomorrow.min.css">

</head>
	<body>
		<div class="bg"></div>
		<div class="wrapper">
			<div class="main-header container">
	<div class="box">
		<h1 class="u-tit"><a href="/">tv_哇</a></h1>
		<div class="m-nav">
			<a href="https://github.com/tvChan" target="_blank" class="nav1_4 iconfont icon-github"></a>
			<a href="http://music.163.com/#/user/home?id=10020158" target="_blank" class="nav1_5 iconfont icon-musiccloud"></a>
			<a href="https://www.zhihu.com/people/tv_wawawa" target="_blank" class="iconfont icon-zhihu"></a>
			<a href="https://www.douban.com/people/tv_wawawa/" target="_blank" class="iconfont icon-douban"></a>
		</div>
	</div>
</div>
			<div class="article-all g-mn" style="padding:0 0 50px">
	<div class="g-box f-cb container">

		<!--文章列表 start-->
		<div class="m-post m-post-text" style="padding-top:68px">
			<div class="cont ">
				<div class="text f-cb">
					<h1 class="title">angular web端开发文档</h1>
					<h2 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h2><blockquote>
<p>components    //第三方组件</p>
<blockquote>
<p>bootstrap-datatimepicker    //基于boostrap的日期选择器<br>font-awesome-4.5.0    //字体图标<br>layer    //弹出层插件<br>qrcode    //JQuery二维码插件</p>
</blockquote>
<p>framework    //全局框架</p>
<blockquote>
<p>angular-1.3.0.14    //Anguler<br>angular-ui-router    //基于Angular的第三方路由<br>bootstrap-3.3.5    //UI框架<br>jquery </p>
</blockquote>
<p>src    //源代码</p>
<blockquote>
<p>common    //公共资源</p>
<blockquote>
<p>css</p>
<blockquote>
<p>base.css    //基础样式：标签初始化<br>common.css    //自定义公共UI组件</p>
</blockquote>
<p>js</p>
<blockquote>
<p>app.js    //Angular启动js：主要是配置路由代码<br>controllers.js    //Controller（控制器）：主要js代码都在里面<br>filters.js    //Filter（过滤器）：过滤data，类似handlebars里面的Handlebars.register<br>services.js    //Service（服务）：自定义服务</p>
</blockquote>
</blockquote>
<p>page    //子页面</p>
<blockquote>
<p>bank.html    //提现帐户<br>comment.html    //评价管理<br>commodity.html    //商品管理（未完成）<br>home.html    //主子页<br>member.html    //会员管理<br>notice.html    //公告设置<br>qrcode.html    //二维码<br>recharge.html    //积分充值<br>withdraw.html    //提现</p>
</blockquote>
<p>panel    //面板（子页面中的功能板块区域）</p>
<blockquote>
<p>account.html    //子主页面 - 用户帐户板块<br>finance.html    //子主页面 - 用户账务板块<br>shortCut.html    //子主页面 - 快捷功能板块</p>
</blockquote>
</blockquote>
<p>api-conf.js    //路径配置<br>fis-conf.js    //fis配置<br>index.html    //入口页面：包括页面头部和左菜单列表</p>
</blockquote>
<a id="more"></a>
<h2 id="FIS-Angular-会遇到的坑"><a href="#FIS-Angular-会遇到的坑" class="headerlink" title="FIS+ Angular 会遇到的坑"></a>FIS+ Angular 会遇到的坑</h2><h3 id="变量命名问题"><a href="#变量命名问题" class="headerlink" title="变量命名问题"></a>变量命名问题</h3><ul>
<li>下面是Angular官方推荐写法：</li>
</ul>
<pre><code class="javascript">moduleName.run(function($rootScope, $state, $stateParams) {
    do something; 
});
moduleName.controller(&#39;moduleCtrl&#39;, function($scope, $http, $state, $stateParams) {
    do something;
});
</code></pre>
<p>代码经fis部署后会进行压缩，变量名会强行改为简写，angular内部变量会被改成t,u,o之类的变量名导致浏览器报错。</p>
<ul>
<li><strong>在FIS下要把内部变量放在数组里面，像下面这样</strong></li>
</ul>
<pre><code class="javascript">moduleName.run([&#39;$rootScope&#39;,&#39;$state&#39;,&#39;$stateParams&#39;,function($rootScope, $state, $stateParams) {
    do something; 
}]);
moduleName.controller(&#39;moduleCtrl&#39;,[&#39;$scope&#39;,&#39;$http&#39;,&#39;$state&#39;,&#39;$stateParams&#39;, function($scope, $http, $state, $stateParams) {
    do something;
}]);
</code></pre>
<h3 id="Ajax-相关问题"><a href="#Ajax-相关问题" class="headerlink" title="Ajax 相关问题"></a>Ajax 相关问题</h3><ul>
<li>angular下仍然可以使用JQuery的AJAX，但是经常会遇到不请求或延迟请求的问题，所以angular下尽量不要使用Ajax。</li>
<li>angular封装了一个叫$http的服务，类似ajax，官方API文档是下面这种写法：</li>
</ul>
<pre><code class="javascript">$http.get(&#39;http:\\static...&#39;, {
    key1:value1,
    key2:value2
}).success(function(data) { 
    do something;
}).error(function(){
    do something;
});
</code></pre>
<p>同样，在FIS下这么写还是会报错，data对象内部还要再加一个params对象才可以，像这样：</p>
<pre><code class="javascript">$http.get(&#39;http:\\static...&#39;, {
    params:{
        key1:value1,
        key2:value2
    }
}).success(function(data) { 
    do something;
}).error(function(){
    do something;
});
</code></pre>
<h3 id="Angular下-计时器-setTimeout-和-setInterval-问题；"><a href="#Angular下-计时器-setTimeout-和-setInterval-问题；" class="headerlink" title="Angular下 计时器 setTimeout 和 setInterval 问题；"></a>Angular下 计时器 setTimeout 和 setInterval 问题；</h3><ul>
<li>Angular下，setTimeout 和 setInterval 虽然可以用，但是如果用setTimeout对数据进行操作，会解除数据与视图的绑定，数据的变化无法体现在视图上，要换成$timeout服务，用法与setTimeout差不多：</li>
</ul>
<pre><code class="javascript"> $timeout(function(){
     dosomething();
 },1000)
</code></pre>
<!--more-->
<h2 id="Router-路由"><a href="#Router-路由" class="headerlink" title="Router 路由"></a>Router 路由</h2><p>Angular本身自带了一个原生路由ngRouter，但是功能简单，而且不能嵌套页面。</p>
<p>商家WEB端用了一个基于angular的第三方路由ui-router，可以进行页面的嵌套。</p>
<p>ui-router使用方法：</p>
<ul>
<li>声明router模块，并注入主业务模块business：</li>
</ul>
<pre><code class="javascript">var routerApp = angular.module(&#39;routerApp&#39;, [&#39;ui.router&#39;,&#39;business&#39;]);    //数组变量表示依赖的模块名；
</code></pre>
<ul>
<li>初始化路由：</li>
</ul>
<pre><code class="javascript">routerApp.run([&#39;$rootScope&#39;,&#39;$state&#39;,&#39;$stateParams&#39;,function($rootScope, $state, $stateParams) {
    $rootScope.$state = $state;
    $rootScope.$stateParams = $stateParams;
}]);
</code></pre>
<ul>
<li>配置路由：</li>
</ul>
<pre><code class="javascript">routerApp.config([&#39;$stateProvider&#39;,&#39;$urlRouterProvider&#39;,function($stateProvider, $urlRouterProvider) {
    $urlRouterProvider.otherwise(&#39;/home&#39;);    //如果#后无参或找到参数，则跳转至&#39;/home&#39;
    $stateProvider
        .state(&#39;home&#39;, {    //#号的索引值
            url: &#39;/home&#39;,    //url
            views: {     //嵌套页面
                &#39;&#39;: {    
                    templateUrl: &#39;src/page/home.html&#39;    //子页面路径
                },
                &#39;shortCut@home&#39;: {    //二级子页面：‘二级页面名@上一级页面名’
                    templateUrl: &#39;src/panel/shortCut.html&#39;    //二级子页面路径
                },
                &#39;account@home&#39;: {
                    templateUrl: &#39;src/panel/account.html&#39;
                },
                &#39;finance@home&#39;: {
                    templateUrl: &#39;src/panel/finance.html&#39;
                }
            }
        })
        .state(&#39;commodity&#39;, {    //非嵌套页面
            url: &#39;/commodity&#39;,
            templateUrl: &#39;src/page/commodity.html&#39;
        })
}]);
</code></pre>
<h2 id="Scope-作用域"><a href="#Scope-作用域" class="headerlink" title="$Scope 作用域"></a>$Scope 作用域</h2><p>Angular中，scope起媒介的作用，将view视图（页面结构）、controller控制器（业务逻辑代码）和model模型（数据）链接起来，controller可以通过改变model控制view，也可以通过改变view操作model。</p>
<ul>
<li><p>scope 可以嵌套，内层scope可以访问外层scope对象，同层scope之间互不影响，下图为商家WEB端首页的scope作用域视图：<br><img src="/img/angular.png" alt="scope"></p>
</li>
<li><p>以下是商家WEB端首页的页面结构：</p>
</li>
</ul>
<pre><code class="javascript">&lt;div ng-controller=&quot;rootCtrl&quot;&gt;
    ...
    &lt;div ng-controller=&quot;shortCutCtrl&quot;&gt;
        ...
    &lt;/div&gt;
    &lt;div ng-controller=&quot;accountCtrl&quot;&gt;
        ...
    &lt;/div&gt;
    &lt;div ng-controller=&quot;financeCtrl&quot;&gt;
        ...
    &lt;/div&gt;
&lt;/div&gt;
</code></pre>
<p><strong>通过给标签添加ng-controller，声明该controller的控制区域，与此同时，该区域的scope对象自动生成，可在页面直接调用scope中的方法和对象，最外层的scope中可以存放全局方法/变量（商家名称，ID之类）以便子层controller可以方便调用。</strong></p>
<h2 id="Controller-控制器"><a href="#Controller-控制器" class="headerlink" title="Controller 控制器"></a>Controller 控制器</h2><h3 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h3><ul>
<li>声明业务模块：</li>
</ul>
<pre><code class="javascript">var business = angular.module(&quot;business&quot;, []);
</code></pre>
<ul>
<li>声明controller：</li>
</ul>
<pre><code class="javascript">business.controller(&#39;recharge&#39;,[&#39;$scope&#39;,&#39;$http&#39;,function($scope,$http){    //$scope一定要有，如没有数据请求，可不加$http服务
    $scope.active = true;    
    $scope.rechargeIntegral = function(){
        $http.get(&#39;&#39;+$api_url+&#39;businessStore!cashAccountRechargeIntegral.do?_id=&#39;+parseInt(Math.random()*100000), {
            params: {
                cash: $scope.integral / 10,
                integral: $scope.integral
            }  
        }).success(function(data) { 
            if(data.status){layer.msg(data.msg);return;} 
            layer.msg(&quot;充值成功&quot;)
            $scope.root.cash -= ($scope.integral / 10);
            $scope.root.integral += $scope.integral;
        }).error(function(){});  
    }
}])
</code></pre>
<ul>
<li>html调用</li>
</ul>
<pre><code class="html">&lt;div&gt;
    &lt;div ng-show=&quot;active&quot;&gt;    //$scope.active 为 true 时显示
            &lt;input type=&quot;number&quot; placeholder=&quot;请输入充值积分&quot; ng-model=&quot;integral&quot;&gt;    //ng-model：与$scope.integral 双向数据绑定
        &lt;p&gt;
            &lt;span&gt;积分余额&lt;/span&gt;
            &lt;span&gt;{{root.integral | number:1}}&lt;/span&gt; 积分    //root.integral：调用最外层根scope变量
        &lt;/p&gt;
        &lt;p&gt;
            &lt;span&gt;需支付&lt;/span&gt;
            &lt;span&gt;{{integral/10 || 0}}&lt;/span&gt; 元
        &lt;/p&gt;
        &lt;button ng-click=&quot;rechargeIntegral()&quot;&gt;确定充值&lt;/button&gt;    //调用$scope.rechargeIntegral()方法
    &lt;/div&gt;
    &lt;div ng-hide=&quot;active&quot; &gt;     //$scope.active 为 true时隐藏
        功能维护中...
    &lt;/div&gt;
&lt;/div&gt;
</code></pre>

				</div>
			</div>
			<div class="subinfo">
				<a href="">
					2016-08-30
				</a>
				
  <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/angular/">angular</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fis/">fis</a></li></ul>

			</div>
		</div>
		<!--文章列表 end-->

		<!--分页 start-->
		<div class="m-page f-cb">
	
		
			<a class="f-fl" href="/2016/08/31/easyUI/">
				上一篇
			</a>
		
		
			<a class="f-fr" href="/2016/08/10/handlerbars的使用/">
				下一篇
			</a>
		
	
</div>
		<!--分页 end-->
	</div>
</div>




			<div class="main-footer">
	<div class="m-ft container"><span title="Copyright">©</span>
		<a href="http://tvwawawa.lofter.com/">tv_哇</a> | Powered by
		<a href="https://hexo.io/">Hexo</a>
	</div>
</div>
		</div>
		<script>
	window.onload = function() {
		// 可爱title切换
		var OriginTitile = document.title;
		var st;
		document.addEventListener('visibilitychange', function() {
			if(document.hidden) {
				document.title = unescape("%28%u3064%u30A7%u2282%29%u6211%u85CF%u597D%u4E86%u54E6") + "★" + OriginTitile;
				clearTimeout(st);
			} else {
				document.title = unescape("%28*%B4%u2207%uFF40*%29%20%20%u88AB%u4F60%u53D1%u73B0%u5566%7E%20") + "★" + OriginTitile;
				st = setTimeout(function() {
					document.title = OriginTitile;
				}, 4000);
			}
		});
	}
</script>
<script src="//cdn.bootcss.com/highlight.js/9.2.0/highlight.min.js"></script> 
<script>hljs.initHighlightingOnLoad();</script> 

		<!--google analytics--> 
		
	</body>
</html>